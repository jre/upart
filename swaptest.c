#include "config.h"

#include <stdio.h>
#include <string.h>

#include "util.h"

int
dotest16(void)
{
    struct { char *big; char *little; uint16_t native; } tests[] = {
        {"\xef\x80", "\x80\xef", 0xef80U},
        {"\x75\x2e", "\x2e\x75", 0x752eU},
        {"\x29\xfc", "\xfc\x29", 0x29fcU},
        {"\x04\x92", "\x92\x04", 0x0492U},
        {"\x06\x30", "\x30\x06", 0x0630U},
        {"\xa2\x1e", "\x1e\xa2", 0xa21eU},
        {"\x6c\xd2", "\xd2\x6c", 0x6cd2U},
        {"\x95\x7d", "\x7d\x95", 0x957dU},
        {"\x1a\xab", "\xab\x1a", 0x1aabU},
        {"\x59\xf2", "\xf2\x59", 0x59f2U},
        {"\x59\x56", "\x56\x59", 0x5956U},
        {"\xd1\x45", "\x45\xd1", 0xd145U},
        {"\x54\xaa", "\xaa\x54", 0x54aaU},
        {"\x0d\x3e", "\x3e\x0d", 0x0d3eU},
        {"\xe8\x3d", "\x3d\xe8", 0xe83dU},
        {"\xc7\xce", "\xce\xc7", 0xc7ceU},
        {"\x71\xcd", "\xcd\x71", 0x71cdU},
        {"\x00\x83", "\x83\x00", 0x0083U},
        {"\xcc\xd0", "\xd0\xcc", 0xccd0U},
        {"\x9f\x78", "\x78\x9f", 0x9f78U},
        {"\x26\x8d", "\x8d\x26", 0x268dU},
        {"\xdd\xea", "\xea\xdd", 0xddeaU},
        {"\xe7\xcd", "\xcd\xe7", 0xe7cdU},
        {"\x68\x8c", "\x8c\x68", 0x688cU},
        {"\x38\x5e", "\x5e\x38", 0x385eU},
        {"\xba\x26", "\x26\xba", 0xba26U},
        {"\x1f\xfe", "\xfe\x1f", 0x1ffeU},
        {"\x35\x69", "\x69\x35", 0x3569U},
        {"\xfc\x35", "\x35\xfc", 0xfc35U},
        {"\x34\x5e", "\x5e\x34", 0x345eU},
        {"\xe1\x84", "\x84\xe1", 0xe184U},
        {"\x92\x27", "\x27\x92", 0x9227U},
        {"\x96\xdd", "\xdd\x96", 0x96ddU},
        {"\xd8\x6f", "\x6f\xd8", 0xd86fU},
        {"\x41\x17", "\x17\x41", 0x4117U},
        {"\x23\xb0", "\xb0\x23", 0x23b0U},
        {"\x68\x24", "\x24\x68", 0x6824U},
        {"\x50\xbf", "\xbf\x50", 0x50bfU},
        {"\x5f\x4e", "\x4e\x5f", 0x5f4eU},
        {"\x9e\xeb", "\xeb\x9e", 0x9eebU},
        {"\x3d\x21", "\x21\x3d", 0x3d21U},
        {"\xaf\x85", "\x85\xaf", 0xaf85U},
        {"\x91\x03", "\x03\x91", 0x9103U},
        {"\x4a\xd0", "\xd0\x4a", 0x4ad0U},
        {"\xb8\x39", "\x39\xb8", 0xb839U},
        {"\x12\x56", "\x56\x12", 0x1256U},
        {"\x7c\x14", "\x14\x7c", 0x7c14U},
        {"\x4e\xed", "\xed\x4e", 0x4eedU},
        {"\xf1\xf6", "\xf6\xf1", 0xf1f6U},
        {"\x00\x5e", "\x5e\x00", 0x005eU},
        {"\x3b\x63", "\x63\x3b", 0x3b63U},
        {"\x1e\x4f", "\x4f\x1e", 0x1e4fU},
        {"\x90\x4d", "\x4d\x90", 0x904dU},
        {"\x00\x71", "\x71\x00", 0x0071U},
        {"\xe8\xa4", "\xa4\xe8", 0xe8a4U},
        {"\xf2\x8b", "\x8b\xf2", 0xf28bU},
        {"\x29\x82", "\x82\x29", 0x2982U},
        {"\x75\x52", "\x52\x75", 0x7552U},
        {"\x8e\xbc", "\xbc\x8e", 0x8ebcU},
        {"\x3d\x90", "\x90\x3d", 0x3d90U},
        {"\x70\x9d", "\x9d\x70", 0x709dU},
        {"\x72\x3d", "\x3d\x72", 0x723dU},
        {"\x7b\x04", "\x04\x7b", 0x7b04U},
        {"\x62\xc4", "\xc4\x62", 0x62c4U},
        {"\xa4\x89", "\x89\xa4", 0xa489U},
        {"\xce\x2d", "\x2d\xce", 0xce2dU},
        {"\xf6\x5c", "\x5c\xf6", 0xf65cU},
        {"\x8b\x96", "\x96\x8b", 0x8b96U},
        {"\xe8\xad", "\xad\xe8", 0xe8adU},
        {"\xb1\x7c", "\x7c\xb1", 0xb17cU},
        {"\x97\x04", "\x04\x97", 0x9704U},
        {"\x0a\xb8", "\xb8\x0a", 0x0ab8U},
        {"\x26\x4a", "\x4a\x26", 0x264aU},
        {"\xa5\x1c", "\x1c\xa5", 0xa51cU},
        {"\xbc\xb9", "\xb9\xbc", 0xbcb9U},
        {"\x8f\x2f", "\x2f\x8f", 0x8f2fU},
        {"\xf4\x5b", "\x5b\xf4", 0xf45bU},
        {"\x71\x8d", "\x8d\x71", 0x718dU},
        {"\x78\x7f", "\x7f\x78", 0x787fU},
        {"\x3c\x22", "\x22\x3c", 0x3c22U},
        {"\xfb\x6d", "\x6d\xfb", 0xfb6dU},
        {"\x42\xd2", "\xd2\x42", 0x42d2U},
        {"\x37\x19", "\x19\x37", 0x3719U},
        {"\xd8\xcb", "\xcb\xd8", 0xd8cbU},
        {"\x37\x3c", "\x3c\x37", 0x373cU},
        {"\x0c\xe5", "\xe5\x0c", 0x0ce5U},
        {"\xd4\x98", "\x98\xd4", 0xd498U},
        {"\x6d\x6c", "\x6c\x6d", 0x6d6cU},
        {"\x95\x14", "\x14\x95", 0x9514U},
        {"\x96\x57", "\x57\x96", 0x9657U},
        {"\x9c\xbb", "\xbb\x9c", 0x9cbbU},
        {"\x35\x6a", "\x6a\x35", 0x356aU},
        {"\x7a\xef", "\xef\x7a", 0x7aefU},
        {"\x31\x2a", "\x2a\x31", 0x312aU},
        {"\x0a\x74", "\x74\x0a", 0x0a74U},
        {"\x48\xb7", "\xb7\x48", 0x48b7U},
        {"\xbf\x86", "\x86\xbf", 0xbf86U},
        {"\x3f\x7e", "\x7e\x3f", 0x3f7eU},
        {"\x5a\xb0", "\xb0\x5a", 0x5ab0U},
        {"\xe6\xdb", "\xdb\xe6", 0xe6dbU},
        {"\x49\x59", "\x59\x49", 0x4959U},
        {"\x67\xbe", "\xbe\x67", 0x67beU},
        {"\xe0\x59", "\x59\xe0", 0xe059U},
        {"\x66\x50", "\x50\x66", 0x6650U},
        {"\x25\x0c", "\x0c\x25", 0x250cU},
        {"\xec\xfa", "\xfa\xec", 0xecfaU},
        {"\x92\x90", "\x90\x92", 0x9290U},
        {"\x47\x0f", "\x0f\x47", 0x470fU},
        {"\x0d\x80", "\x80\x0d", 0x0d80U},
        {"\x01\xf1", "\xf1\x01", 0x01f1U},
        {"\x76\xea", "\xea\x76", 0x76eaU},
        {"\x5b\x88", "\x88\x5b", 0x5b88U},
        {"\x94\x8e", "\x8e\x94", 0x948eU},
        {"\x24\x19", "\x19\x24", 0x2419U},
        {"\x42\x96", "\x96\x42", 0x4296U},
        {"\x46\x9d", "\x9d\x46", 0x469dU},
        {"\x61\xcc", "\xcc\x61", 0x61ccU},
        {"\xa5\x97", "\x97\xa5", 0xa597U},
        {"\xf2\x00", "\x00\xf2", 0xf200U},
        {"\x35\xed", "\xed\x35", 0x35edU},
        {"\xe2\x09", "\x09\xe2", 0xe209U},
        {"\x23\xb8", "\xb8\x23", 0x23b8U},
        {"\x3b\xe8", "\xe8\x3b", 0x3be8U},
        {"\xdb\xa6", "\xa6\xdb", 0xdba6U},
        {"\xfe\xf3", "\xf3\xfe", 0xfef3U},
        {"\xcd\x2b", "\x2b\xcd", 0xcd2bU},
        {"\xe1\x3d", "\x3d\xe1", 0xe13dU},
        {"\xf4\x59", "\x59\xf4", 0xf459U},
    };
    uint16_t numl, numb;
    uint8_t bufl[2], bufb[2];
    int ii, fail;

    fail = 0;
    for(ii = 0; sizeof(tests) / sizeof(tests[0]) > ii; ii++)
    {
        numl = UP_GETBUF16LE(tests[ii].little);
        numb = UP_GETBUF16BE(tests[ii].big);
        UP_SETBUF16LE(bufl, tests[ii].native);
        UP_SETBUF16BE(bufb, tests[ii].native);
        if(numl != tests[ii].native ||
           numb != tests[ii].native ||
           memcmp(bufl, tests[ii].little, 2) ||
           memcmp(bufb, tests[ii].big, 2))
        {
            fail = 1;
            printf("16/%d: getle=%s getbe=%s setle=%s setbe=%s\n", ii,
                   (numl == tests[ii].native ? "pass" : "fail"),
                   (numb == tests[ii].native  ? "pass" : "fail"),
                   (!memcmp(bufl, tests[ii].little, 2) ? "pass" : "fail"),
                   (!memcmp(bufb, tests[ii].big, 2) ? "pass" : "fail"));
        }
    }

    return fail;
}

int
dotest32(void)
{
    struct { char *big; char *little; uint32_t native; } tests[] = {
        {"\xba\xce\x2d\x17", "\x17\x2d\xce\xba", 0xbace2d17UL},
        {"\x83\xba\xf1\x3b", "\x3b\xf1\xba\x83", 0x83baf13bUL},
        {"\xea\x9f\x99\x8e", "\x8e\x99\x9f\xea", 0xea9f998eUL},
        {"\x87\x67\x26\x6e", "\x6e\x26\x67\x87", 0x8767266eUL},
        {"\x49\x9e\xb3\xbe", "\xbe\xb3\x9e\x49", 0x499eb3beUL},
        {"\x0f\x81\x5a\xfd", "\xfd\x5a\x81\x0f", 0x0f815afdUL},
        {"\x50\x04\x0f\x15", "\x15\x0f\x04\x50", 0x50040f15UL},
        {"\x61\x81\x94\x24", "\x24\x94\x81\x61", 0x61819424UL},
        {"\xd1\xc5\xe2\x30", "\x30\xe2\xc5\xd1", 0xd1c5e230UL},
        {"\xdd\xf8\xd4\x8c", "\x8c\xd4\xf8\xdd", 0xddf8d48cUL},
        {"\x7d\xfb\xa5\xac", "\xac\xa5\xfb\x7d", 0x7dfba5acUL},
        {"\xf1\x93\x25\x3b", "\x3b\x25\x93\xf1", 0xf193253bUL},
        {"\xc2\xee\x43\x56", "\x56\x43\xee\xc2", 0xc2ee4356UL},
        {"\x47\xae\x39\x1b", "\x1b\x39\xae\x47", 0x47ae391bUL},
        {"\x13\x7d\x72\x40", "\x40\x72\x7d\x13", 0x137d7240UL},
        {"\xe1\x4c\x4c\x9c", "\x9c\x4c\x4c\xe1", 0xe14c4c9cUL},
        {"\x5b\x4c\xbe\xbc", "\xbc\xbe\x4c\x5b", 0x5b4cbebcUL},
        {"\xdf\x3a\xce\xcf", "\xcf\xce\x3a\xdf", 0xdf3acecfUL},
        {"\x97\xab\x01\x52", "\x52\x01\xab\x97", 0x97ab0152UL},
        {"\x5a\xcd\x98\x37", "\x37\x98\xcd\x5a", 0x5acd9837UL},
        {"\xe4\x89\x44\xfe", "\xfe\x44\x89\xe4", 0xe48944feUL},
        {"\x5e\x7b\xa0\x60", "\x60\xa0\x7b\x5e", 0x5e7ba060UL},
        {"\x69\xfe\x5b\x2f", "\x2f\x5b\xfe\x69", 0x69fe5b2fUL},
        {"\x2a\x1e\x68\x2c", "\x2c\x68\x1e\x2a", 0x2a1e682cUL},
        {"\xad\x18\x5c\xa2", "\xa2\x5c\x18\xad", 0xad185ca2UL},
        {"\x23\xd2\x6f\xf8", "\xf8\x6f\xd2\x23", 0x23d26ff8UL},
        {"\xc7\x42\x23\x10", "\x10\x23\x42\xc7", 0xc7422310UL},
        {"\xa4\xae\xe1\xc3", "\xc3\xe1\xae\xa4", 0xa4aee1c3UL},
        {"\xac\xb1\xc1\x89", "\x89\xc1\xb1\xac", 0xacb1c189UL},
        {"\x10\xe0\x77\x15", "\x15\x77\xe0\x10", 0x10e07715UL},
        {"\x6a\x1a\x3f\x60", "\x60\x3f\x1a\x6a", 0x6a1a3f60UL},
        {"\x53\x59\xdc\xb2", "\xb2\xdc\x59\x53", 0x5359dcb2UL},
        {"\x4b\xea\x5b\x24", "\x24\x5b\xea\x4b", 0x4bea5b24UL},
        {"\xb4\x3a\xee\xfc", "\xfc\xee\x3a\xb4", 0xb43aeefcUL},
        {"\x6c\x53\xa9\xc9", "\xc9\xa9\x53\x6c", 0x6c53a9c9UL},
        {"\x60\x10\xf6\x2d", "\x2d\xf6\x10\x60", 0x6010f62dUL},
        {"\x09\x52\xd7\x9a", "\x9a\xd7\x52\x09", 0x0952d79aUL},
        {"\xcc\xa9\x45\xa9", "\xa9\x45\xa9\xcc", 0xcca945a9UL},
        {"\xec\x08\x65\xe4", "\xe4\x65\x08\xec", 0xec0865e4UL},
        {"\xff\x72\x2b\x59", "\x59\x2b\x72\xff", 0xff722b59UL},
        {"\x39\xd9\x70\x38", "\x38\x70\xd9\x39", 0x39d97038UL},
        {"\x19\x2f\x95\xb0", "\xb0\x95\x2f\x19", 0x192f95b0UL},
        {"\x23\x3b\x62\x61", "\x61\x62\x3b\x23", 0x233b6261UL},
        {"\xe8\x24\x43\xc1", "\xc1\x43\x24\xe8", 0xe82443c1UL},
        {"\x71\x09\xe4\x4b", "\x4b\xe4\x09\x71", 0x7109e44bUL},
        {"\x92\x4d\x82\x47", "\x47\x82\x4d\x92", 0x924d8247UL},
        {"\x22\x99\xcf\x09", "\x09\xcf\x99\x22", 0x2299cf09UL},
        {"\xf2\x68\xb7\x52", "\x52\xb7\x68\xf2", 0xf268b752UL},
        {"\xff\x42\x41\xd0", "\xd0\x41\x42\xff", 0xff4241d0UL},
        {"\xc4\x6d\xbc\xe9", "\xe9\xbc\x6d\xc4", 0xc46dbce9UL},
        {"\x4c\xd0\x71\xdf", "\xdf\x71\xd0\x4c", 0x4cd071dfUL},
        {"\x9b\xb6\x85\x3d", "\x3d\x85\xb6\x9b", 0x9bb6853dUL},
        {"\x97\xcc\x87\x36", "\x36\x87\xcc\x97", 0x97cc8736UL},
        {"\x24\xde\x60\xf4", "\xf4\x60\xde\x24", 0x24de60f4UL},
        {"\xec\x9d\xdc\x30", "\x30\xdc\x9d\xec", 0xec9ddc30UL},
        {"\x65\x66\x86\xea", "\xea\x86\x66\x65", 0x656686eaUL},
        {"\x21\x71\xdf\xf9", "\xf9\xdf\x71\x21", 0x2171dff9UL},
        {"\x9f\xdf\xbf\x89", "\x89\xbf\xdf\x9f", 0x9fdfbf89UL},
        {"\xa7\xc9\x93\xfa", "\xfa\x93\xc9\xa7", 0xa7c993faUL},
        {"\xc8\x75\xc0\x30", "\x30\xc0\x75\xc8", 0xc875c030UL},
        {"\x72\x37\x27\xd3", "\xd3\x27\x37\x72", 0x723727d3UL},
        {"\x86\xb6\xe6\x1e", "\x1e\xe6\xb6\x86", 0x86b6e61eUL},
        {"\x2b\x4f\xcb\xbc", "\xbc\xcb\x4f\x2b", 0x2b4fcbbcUL},
        {"\x82\x23\xbe\xc3", "\xc3\xbe\x23\x82", 0x8223bec3UL},
        {"\xd2\xf9\xef\x6d", "\x6d\xef\xf9\xd2", 0xd2f9ef6dUL},
        {"\x8a\x3a\xf5\x0b", "\x0b\xf5\x3a\x8a", 0x8a3af50bUL},
        {"\xc1\x7d\x9e\x31", "\x31\x9e\x7d\xc1", 0xc17d9e31UL},
        {"\xe7\x1d\x5a\x0b", "\x0b\x5a\x1d\xe7", 0xe71d5a0bUL},
        {"\xe7\x1f\x91\xbe", "\xbe\x91\x1f\xe7", 0xe71f91beUL},
        {"\x37\xa0\x4c\xb6", "\xb6\x4c\xa0\x37", 0x37a04cb6UL},
        {"\x97\xc7\x4d\x15", "\x15\x4d\xc7\x97", 0x97c74d15UL},
        {"\x7b\x56\x64\xe9", "\xe9\x64\x56\x7b", 0x7b5664e9UL},
        {"\xfc\x56\x92\x99", "\x99\x92\x56\xfc", 0xfc569299UL},
        {"\x8c\xf3\x57\xf2", "\xf2\x57\xf3\x8c", 0x8cf357f2UL},
        {"\x8d\xe7\x3f\xdd", "\xdd\x3f\xe7\x8d", 0x8de73fddUL},
        {"\x03\x19\x5a\x4c", "\x4c\x5a\x19\x03", 0x03195a4cUL},
        {"\xa1\x73\x3b\x38", "\x38\x3b\x73\xa1", 0xa1733b38UL},
        {"\x1c\x16\x1d\x11", "\x11\x1d\x16\x1c", 0x1c161d11UL},
        {"\x4b\x94\xdb\x67", "\x67\xdb\x94\x4b", 0x4b94db67UL},
        {"\x04\xb7\x4e\xa1", "\xa1\x4e\xb7\x04", 0x04b74ea1UL},
        {"\x3c\xf9\x9f\xe0", "\xe0\x9f\xf9\x3c", 0x3cf99fe0UL},
        {"\xda\x63\x20\xc5", "\xc5\x20\x63\xda", 0xda6320c5UL},
        {"\x9d\xe6\x18\x49", "\x49\x18\xe6\x9d", 0x9de61849UL},
        {"\xe7\xfd\xa7\x99", "\x99\xa7\xfd\xe7", 0xe7fda799UL},
        {"\x41\xa0\xe1\xe1", "\xe1\xe1\xa0\x41", 0x41a0e1e1UL},
        {"\x0b\xc6\x43\xfe", "\xfe\x43\xc6\x0b", 0x0bc643feUL},
        {"\x1a\x7a\xba\x2c", "\x2c\xba\x7a\x1a", 0x1a7aba2cUL},
        {"\xc6\xc1\xa9\x94", "\x94\xa9\xc1\xc6", 0xc6c1a994UL},
        {"\x7b\x66\xfe\x0d", "\x0d\xfe\x66\x7b", 0x7b66fe0dUL},
        {"\x02\x61\x13\x48", "\x48\x13\x61\x02", 0x02611348UL},
        {"\xc1\x34\xd0\xa6", "\xa6\xd0\x34\xc1", 0xc134d0a6UL},
        {"\x2c\x98\x37\xa2", "\xa2\x37\x98\x2c", 0x2c9837a2UL},
        {"\xd1\x00\x24\x9b", "\x9b\x24\x00\xd1", 0xd100249bUL},
        {"\x36\x07\xd3\xc0", "\xc0\xd3\x07\x36", 0x3607d3c0UL},
        {"\x66\xd2\x90\x65", "\x65\x90\xd2\x66", 0x66d29065UL},
        {"\xf2\x0b\xdd\x2c", "\x2c\xdd\x0b\xf2", 0xf20bdd2cUL},
        {"\xed\x20\x57\xbe", "\xbe\x57\x20\xed", 0xed2057beUL},
        {"\x13\x17\x19\x31", "\x31\x19\x17\x13", 0x13171931UL},
        {"\x7a\xbf\x70\xda", "\xda\x70\xbf\x7a", 0x7abf70daUL},
        {"\xb4\x01\xfc\x90", "\x90\xfc\x01\xb4", 0xb401fc90UL},
        {"\xeb\x8f\xc1\x91", "\x91\xc1\x8f\xeb", 0xeb8fc191UL},
        {"\x4c\xcc\xb9\x65", "\x65\xb9\xcc\x4c", 0x4cccb965UL},
        {"\xa8\xe6\x6a\xda", "\xda\x6a\xe6\xa8", 0xa8e66adaUL},
        {"\x2e\x14\x95\x42", "\x42\x95\x14\x2e", 0x2e149542UL},
        {"\xe0\xbb\x04\x08", "\x08\x04\xbb\xe0", 0xe0bb0408UL},
        {"\x8a\x76\xfb\xfd", "\xfd\xfb\x76\x8a", 0x8a76fbfdUL},
        {"\xf0\x5c\x32\xdc", "\xdc\x32\x5c\xf0", 0xf05c32dcUL},
        {"\xc7\x60\xf0\xa0", "\xa0\xf0\x60\xc7", 0xc760f0a0UL},
        {"\xd5\x80\xfb\xbc", "\xbc\xfb\x80\xd5", 0xd580fbbcUL},
        {"\x68\x68\x97\xec", "\xec\x97\x68\x68", 0x686897ecUL},
        {"\xe6\x28\x6b\x8f", "\x8f\x6b\x28\xe6", 0xe6286b8fUL},
        {"\x05\xb9\xcd\xf7", "\xf7\xcd\xb9\x05", 0x05b9cdf7UL},
        {"\xc0\x4f\xcf\x5a", "\x5a\xcf\x4f\xc0", 0xc04fcf5aUL},
        {"\xdd\xee\x81\x1d", "\x1d\x81\xee\xdd", 0xddee811dUL},
        {"\x2a\x14\x12\x05", "\x05\x12\x14\x2a", 0x2a141205UL},
        {"\xa2\xe0\x05\x14", "\x14\x05\xe0\xa2", 0xa2e00514UL},
        {"\x5d\x9c\xb9\x9f", "\x9f\xb9\x9c\x5d", 0x5d9cb99fUL},
        {"\xe0\xb6\xe1\x43", "\x43\xe1\xb6\xe0", 0xe0b6e143UL},
        {"\x40\xd3\xa2\x20", "\x20\xa2\xd3\x40", 0x40d3a220UL},
        {"\x65\xe3\x71\xa8", "\xa8\x71\xe3\x65", 0x65e371a8UL},
        {"\x33\x67\xee\x02", "\x02\xee\x67\x33", 0x3367ee02UL},
        {"\xd8\xee\x23\x88", "\x88\x23\xee\xd8", 0xd8ee2388UL},
        {"\x08\xf8\x68\xd5", "\xd5\x68\xf8\x08", 0x08f868d5UL},
        {"\xd7\xeb\x63\x01", "\x01\x63\xeb\xd7", 0xd7eb6301UL},
        {"\x3c\x32\x92\x3b", "\x3b\x92\x32\x3c", 0x3c32923bUL},
        {"\xbe\x05\x59\xcd", "\xcd\x59\x05\xbe", 0xbe0559cdUL},
        {"\xcd\x35\x9e\x5e", "\x5e\x9e\x35\xcd", 0xcd359e5eUL},
        {"\x74\x4c\x01\x57", "\x57\x01\x4c\x74", 0x744c0157UL},
    };
    uint32_t numl, numb;
    uint8_t bufl[4], bufb[4];
    int ii, fail;

    fail = 0;
    for(ii = 0; sizeof(tests) / sizeof(tests[0]) > ii; ii++)
    {
        numl = UP_GETBUF32LE(tests[ii].little);
        numb = UP_GETBUF32BE(tests[ii].big);
        UP_SETBUF32LE(bufl, tests[ii].native);
        UP_SETBUF32BE(bufb, tests[ii].native);
        if(numl != tests[ii].native ||
           numb != tests[ii].native ||
           memcmp(bufl, tests[ii].little, 4) ||
           memcmp(bufb, tests[ii].big, 4))
        {
            fail = 1;
            printf("32/%d: getle=%s getbe=%s setle=%s setbe=%s\n", ii,
                   (numl == tests[ii].native ? "pass" : "fail"),
                   (numb == tests[ii].native  ? "pass" : "fail"),
                   (!memcmp(bufl, tests[ii].little, 4) ? "pass" : "fail"),
                   (!memcmp(bufb, tests[ii].big, 4) ? "pass" : "fail"));
        }
    }

    return fail;
}

int
dotest64(void)
{
    struct { char *big; char *little; uint64_t native; } tests[] = {
        {"\xf1\xdc\x7f\x77\x31\x31\x84\xed", "\xed\x84\x31\x31\x77\x7f\xdc\xf1", 0xf1dc7f77313184edULL},
        {"\xe3\x59\xec\xf4\xe2\x1e\x28\x3f", "\x3f\x28\x1e\xe2\xf4\xec\x59\xe3", 0xe359ecf4e21e283fULL},
        {"\x99\x34\xbd\x14\x54\xfa\x1f\xaa", "\xaa\x1f\xfa\x54\x14\xbd\x34\x99", 0x9934bd1454fa1faaULL},
        {"\x18\xae\x44\x51\x30\x08\x6a\xd9", "\xd9\x6a\x08\x30\x51\x44\xae\x18", 0x18ae445130086ad9ULL},
        {"\xd5\xdf\xf2\x20\xce\xe1\xf9\x86", "\x86\xf9\xe1\xce\x20\xf2\xdf\xd5", 0xd5dff220cee1f986ULL},
        {"\x9a\xea\x6f\x42\x61\xfd\x3c\x46", "\x46\x3c\xfd\x61\x42\x6f\xea\x9a", 0x9aea6f4261fd3c46ULL},
        {"\xc7\xa1\xb7\x2f\x85\x2a\x42\xd9", "\xd9\x42\x2a\x85\x2f\xb7\xa1\xc7", 0xc7a1b72f852a42d9ULL},
        {"\x8b\xf8\xca\x69\xf2\x81\xc5\xff", "\xff\xc5\x81\xf2\x69\xca\xf8\x8b", 0x8bf8ca69f281c5ffULL},
        {"\xff\xf0\xfc\x82\x8d\x29\xb7\xb7", "\xb7\xb7\x29\x8d\x82\xfc\xf0\xff", 0xfff0fc828d29b7b7ULL},
        {"\x52\x72\x02\x14\xc9\x67\xb3\x9a", "\x9a\xb3\x67\xc9\x14\x02\x72\x52", 0x52720214c967b39aULL},
        {"\xeb\x4e\xc2\x51\x81\xc8\xf2\xa9", "\xa9\xf2\xc8\x81\x51\xc2\x4e\xeb", 0xeb4ec25181c8f2a9ULL},
        {"\xa8\x67\x7f\xac\xca\x3a\xd3\x31", "\x31\xd3\x3a\xca\xac\x7f\x67\xa8", 0xa8677facca3ad331ULL},
        {"\x0d\xa0\x5a\xa8\xc5\xda\xff\x16", "\x16\xff\xda\xc5\xa8\x5a\xa0\x0d", 0x0da05aa8c5daff16ULL},
        {"\x86\x28\xfb\xd9\x2b\x78\x34\xce", "\xce\x34\x78\x2b\xd9\xfb\x28\x86", 0x8628fbd92b7834ceULL},
        {"\x50\x47\x7a\x2b\x81\x5b\xc5\x2d", "\x2d\xc5\x5b\x81\x2b\x7a\x47\x50", 0x50477a2b815bc52dULL},
        {"\x35\xe9\xfc\xb5\xc1\x46\xa3\x82", "\x82\xa3\x46\xc1\xb5\xfc\xe9\x35", 0x35e9fcb5c146a382ULL},
        {"\xd1\xac\xd6\xd6\x9a\x71\xe0\x84", "\x84\xe0\x71\x9a\xd6\xd6\xac\xd1", 0xd1acd6d69a71e084ULL},
        {"\x95\x49\xf7\x2c\x84\x09\xa8\x49", "\x49\xa8\x09\x84\x2c\xf7\x49\x95", 0x9549f72c8409a849ULL},
        {"\xd5\xbc\x2b\x7a\x81\x56\x0c\x1c", "\x1c\x0c\x56\x81\x7a\x2b\xbc\xd5", 0xd5bc2b7a81560c1cULL},
        {"\x01\x5b\xf6\x7c\x5e\x3e\xae\x7b", "\x7b\xae\x3e\x5e\x7c\xf6\x5b\x01", 0x015bf67c5e3eae7bULL},
        {"\xe3\x41\x67\x7a\x2d\x4d\x36\x99", "\x99\x36\x4d\x2d\x7a\x67\x41\xe3", 0xe341677a2d4d3699ULL},
        {"\xc7\x59\x0c\x1c\xf2\x0b\x34\x4d", "\x4d\x34\x0b\xf2\x1c\x0c\x59\xc7", 0xc7590c1cf20b344dULL},
        {"\x3b\xd3\x3c\x77\x3d\xa2\x1c\x6f", "\x6f\x1c\xa2\x3d\x77\x3c\xd3\x3b", 0x3bd33c773da21c6fULL},
        {"\xb3\x1b\x35\xd0\x81\xa3\x90\x5b", "\x5b\x90\xa3\x81\xd0\x35\x1b\xb3", 0xb31b35d081a3905bULL},
        {"\xdb\x86\x17\x8f\x75\xb0\x55\x24", "\x24\x55\xb0\x75\x8f\x17\x86\xdb", 0xdb86178f75b05524ULL},
        {"\xd7\x90\xad\x74\xe1\x31\x47\x21", "\x21\x47\x31\xe1\x74\xad\x90\xd7", 0xd790ad74e1314721ULL},
        {"\x0d\x51\x82\xc5\xa7\x8e\x43\x93", "\x93\x43\x8e\xa7\xc5\x82\x51\x0d", 0x0d5182c5a78e4393ULL},
        {"\x7c\x93\xbe\xcf\x95\x1d\xb2\xea", "\xea\xb2\x1d\x95\xcf\xbe\x93\x7c", 0x7c93becf951db2eaULL},
        {"\x62\x45\xd2\xee\x4e\xac\x94\x1b", "\x1b\x94\xac\x4e\xee\xd2\x45\x62", 0x6245d2ee4eac941bULL},
        {"\x2a\x53\x08\xea\xf8\x1d\x0d\x25", "\x25\x0d\x1d\xf8\xea\x08\x53\x2a", 0x2a5308eaf81d0d25ULL},
        {"\x79\xd9\x29\x87\x3f\x06\xc8\x7c", "\x7c\xc8\x06\x3f\x87\x29\xd9\x79", 0x79d929873f06c87cULL},
        {"\xf8\x23\x82\x32\xb2\x0f\xc0\xe4", "\xe4\xc0\x0f\xb2\x32\x82\x23\xf8", 0xf8238232b20fc0e4ULL},
        {"\x5a\xbc\xa5\x72\x6e\x41\xe0\x5e", "\x5e\xe0\x41\x6e\x72\xa5\xbc\x5a", 0x5abca5726e41e05eULL},
        {"\xe6\x3b\xa8\x95\x9b\x33\x98\xf0", "\xf0\x98\x33\x9b\x95\xa8\x3b\xe6", 0xe63ba8959b3398f0ULL},
        {"\x43\xf2\xdd\x4a\x64\xf3\x0e\xa6", "\xa6\x0e\xf3\x64\x4a\xdd\xf2\x43", 0x43f2dd4a64f30ea6ULL},
        {"\xca\xcd\x31\x90\x97\x1b\x93\xdb", "\xdb\x93\x1b\x97\x90\x31\xcd\xca", 0xcacd3190971b93dbULL},
        {"\xf6\x51\x1d\x61\x0b\x52\x9d\x7b", "\x7b\x9d\x52\x0b\x61\x1d\x51\xf6", 0xf6511d610b529d7bULL},
        {"\xba\xe6\x56\xc7\xa4\xf9\xcd\xe7", "\xe7\xcd\xf9\xa4\xc7\x56\xe6\xba", 0xbae656c7a4f9cde7ULL},
        {"\x92\x83\xd0\x12\x99\xfd\x0c\x91", "\x91\x0c\xfd\x99\x12\xd0\x83\x92", 0x9283d01299fd0c91ULL},
        {"\x01\x5d\xe3\x6d\xe9\xa3\xc6\x9d", "\x9d\xc6\xa3\xe9\x6d\xe3\x5d\x01", 0x015de36de9a3c69dULL},
        {"\x32\x9e\x38\xd9\xc7\x04\x97\x82", "\x82\x97\x04\xc7\xd9\x38\x9e\x32", 0x329e38d9c7049782ULL},
        {"\xcd\x62\xc2\x82\x45\xe0\xe2\x46", "\x46\xe2\xe0\x45\x82\xc2\x62\xcd", 0xcd62c28245e0e246ULL},
        {"\xf3\xc9\x97\x9d\x20\xfc\xfc\xd0", "\xd0\xfc\xfc\x20\x9d\x97\xc9\xf3", 0xf3c9979d20fcfcd0ULL},
        {"\x63\xac\xa0\x65\x80\xd1\xc4\xcb", "\xcb\xc4\xd1\x80\x65\xa0\xac\x63", 0x63aca06580d1c4cbULL},
        {"\xc2\x86\x58\x00\x67\x43\x6d\x92", "\x92\x6d\x43\x67\x00\x58\x86\xc2", 0xc286580067436d92ULL},
        {"\xce\x5f\x50\x82\x95\xa9\x84\xe3", "\xe3\x84\xa9\x95\x82\x50\x5f\xce", 0xce5f508295a984e3ULL},
        {"\x46\x46\x46\xdb\x73\x50\x62\x8b", "\x8b\x62\x50\x73\xdb\x46\x46\x46", 0x464646db7350628bULL},
        {"\xcf\x6a\x25\x47\xc4\x06\xf5\xc0", "\xc0\xf5\x06\xc4\x47\x25\x6a\xcf", 0xcf6a2547c406f5c0ULL},
        {"\x54\x52\x8e\x56\xe9\x33\xd2\x2d", "\x2d\xd2\x33\xe9\x56\x8e\x52\x54", 0x54528e56e933d22dULL},
        {"\x0c\x86\x67\x61\x7e\x84\x96\x77", "\x77\x96\x84\x7e\x61\x67\x86\x0c", 0x0c8667617e849677ULL},
        {"\x2b\x2a\x6f\x45\x69\x52\x7b\x27", "\x27\x7b\x52\x69\x45\x6f\x2a\x2b", 0x2b2a6f4569527b27ULL},
        {"\xaf\x88\x20\xd3\x16\x47\xe4\x55", "\x55\xe4\x47\x16\xd3\x20\x88\xaf", 0xaf8820d31647e455ULL},
        {"\x95\x2a\x63\xb7\x57\xbd\x1e\xe2", "\xe2\x1e\xbd\x57\xb7\x63\x2a\x95", 0x952a63b757bd1ee2ULL},
        {"\xea\x57\x1c\x73\x32\xb2\x07\xac", "\xac\x07\xb2\x32\x73\x1c\x57\xea", 0xea571c7332b207acULL},
        {"\xc1\xdd\xe3\x3b\xd8\x61\xdd\x3a", "\x3a\xdd\x61\xd8\x3b\xe3\xdd\xc1", 0xc1dde33bd861dd3aULL},
        {"\xe7\x5a\xf1\xe0\x59\xe2\xb7\xad", "\xad\xb7\xe2\x59\xe0\xf1\x5a\xe7", 0xe75af1e059e2b7adULL},
        {"\x3b\x09\x99\x45\x70\x71\x45\x2a", "\x2a\x45\x71\x70\x45\x99\x09\x3b", 0x3b0999457071452aULL},
        {"\xaf\xbd\xbf\xbd\x30\x37\x0b\xda", "\xda\x0b\x37\x30\xbd\xbf\xbd\xaf", 0xafbdbfbd30370bdaULL},
        {"\xc2\x14\x8d\x05\x38\x37\x1f\xa8", "\xa8\x1f\x37\x38\x05\x8d\x14\xc2", 0xc2148d0538371fa8ULL},
        {"\x21\x2a\xb8\x7b\x49\x7f\x98\xb0", "\xb0\x98\x7f\x49\x7b\xb8\x2a\x21", 0x212ab87b497f98b0ULL},
        {"\x47\xa6\x17\x98\xa6\x06\xd5\x91", "\x91\xd5\x06\xa6\x98\x17\xa6\x47", 0x47a61798a606d591ULL},
        {"\xde\x7b\x5a\x39\x34\x7f\x36\xf1", "\xf1\x36\x7f\x34\x39\x5a\x7b\xde", 0xde7b5a39347f36f1ULL},
        {"\xe6\x60\xc4\x78\xbd\x0b\xf5\x3c", "\x3c\xf5\x0b\xbd\x78\xc4\x60\xe6", 0xe660c478bd0bf53cULL},
        {"\xc7\x8b\x17\x54\x67\xf3\x2e\x9c", "\x9c\x2e\xf3\x67\x54\x17\x8b\xc7", 0xc78b175467f32e9cULL},
        {"\x19\xe4\x0d\xef\x1d\xde\xf2\x82", "\x82\xf2\xde\x1d\xef\x0d\xe4\x19", 0x19e40def1ddef282ULL},
        {"\xf9\xfd\x3f\x1a\x26\xa9\x46\xe4", "\xe4\x46\xa9\x26\x1a\x3f\xfd\xf9", 0xf9fd3f1a26a946e4ULL},
        {"\xbc\xdd\x35\x8c\x1a\xf1\xbb\xc5", "\xc5\xbb\xf1\x1a\x8c\x35\xdd\xbc", 0xbcdd358c1af1bbc5ULL},
        {"\x51\xc3\x89\x19\xfe\x65\xd3\x57", "\x57\xd3\x65\xfe\x19\x89\xc3\x51", 0x51c38919fe65d357ULL},
        {"\x1d\xfd\xc0\x6a\x2a\xc6\x00\xd3", "\xd3\x00\xc6\x2a\x6a\xc0\xfd\x1d", 0x1dfdc06a2ac600d3ULL},
        {"\x64\x8b\x6b\x2f\xcc\x4e\x2f\x04", "\x04\x2f\x4e\xcc\x2f\x6b\x8b\x64", 0x648b6b2fcc4e2f04ULL},
        {"\x16\xa2\xd5\x9c\x8b\x48\x91\xaf", "\xaf\x91\x48\x8b\x9c\xd5\xa2\x16", 0x16a2d59c8b4891afULL},
        {"\xf7\xad\x4b\x1f\xbe\x71\xdf\xc6", "\xc6\xdf\x71\xbe\x1f\x4b\xad\xf7", 0xf7ad4b1fbe71dfc6ULL},
        {"\xde\xbb\x4e\x9a\xc9\xba\xb4\x0b", "\x0b\xb4\xba\xc9\x9a\x4e\xbb\xde", 0xdebb4e9ac9bab40bULL},
        {"\xaa\xbb\xc1\x84\x6e\xe4\x59\xcc", "\xcc\x59\xe4\x6e\x84\xc1\xbb\xaa", 0xaabbc1846ee459ccULL},
        {"\xbe\x81\xaa\x33\xd4\xdf\xeb\x55", "\x55\xeb\xdf\xd4\x33\xaa\x81\xbe", 0xbe81aa33d4dfeb55ULL},
        {"\x29\xf4\xa4\x80\x84\x6a\x1e\x16", "\x16\x1e\x6a\x84\x80\xa4\xf4\x29", 0x29f4a480846a1e16ULL},
        {"\x6a\xbd\x6c\x14\xcd\xa4\xbd\x6a", "\x6a\xbd\xa4\xcd\x14\x6c\xbd\x6a", 0x6abd6c14cda4bd6aULL},
        {"\x8f\xae\x1e\x0f\xf6\x10\x8f\x6a", "\x6a\x8f\x10\xf6\x0f\x1e\xae\x8f", 0x8fae1e0ff6108f6aULL},
        {"\x7a\x1c\x3a\xc1\x52\x4e\x49\x0f", "\x0f\x49\x4e\x52\xc1\x3a\x1c\x7a", 0x7a1c3ac1524e490fULL},
        {"\x9a\xee\x3a\x48\xe2\xf8\x9b\xa5", "\xa5\x9b\xf8\xe2\x48\x3a\xee\x9a", 0x9aee3a48e2f89ba5ULL},
        {"\x7a\x81\x70\x59\x5a\x1f\xa4\xb1", "\xb1\xa4\x1f\x5a\x59\x70\x81\x7a", 0x7a8170595a1fa4b1ULL},
        {"\x98\x78\xdc\x09\xfd\x33\xb0\xf1", "\xf1\xb0\x33\xfd\x09\xdc\x78\x98", 0x9878dc09fd33b0f1ULL},
        {"\x91\xfd\x59\x81\x00\x9e\x30\x4c", "\x4c\x30\x9e\x00\x81\x59\xfd\x91", 0x91fd5981009e304cULL},
        {"\x77\x14\xef\x12\x51\xe4\xa9\xf9", "\xf9\xa9\xe4\x51\x12\xef\x14\x77", 0x7714ef1251e4a9f9ULL},
        {"\xaf\xd6\x77\x6d\xfa\x78\x26\x53", "\x53\x26\x78\xfa\x6d\x77\xd6\xaf", 0xafd6776dfa782653ULL},
        {"\x3c\x94\xcb\xa8\x77\x64\x04\x27", "\x27\x04\x64\x77\xa8\xcb\x94\x3c", 0x3c94cba877640427ULL},
        {"\xd6\x2a\xce\xa2\x13\xd7\x81\xf2", "\xf2\x81\xd7\x13\xa2\xce\x2a\xd6", 0xd62acea213d781f2ULL},
        {"\x7c\x37\xc2\x1b\xb2\xd8\xc2\x41", "\x41\xc2\xd8\xb2\x1b\xc2\x37\x7c", 0x7c37c21bb2d8c241ULL},
        {"\x02\x6c\xbc\x82\xc4\xb8\x18\x08", "\x08\x18\xb8\xc4\x82\xbc\x6c\x02", 0x026cbc82c4b81808ULL},
        {"\x66\x4d\x69\x31\xc3\xb2\xc8\xe8", "\xe8\xc8\xb2\xc3\x31\x69\x4d\x66", 0x664d6931c3b2c8e8ULL},
        {"\xbc\x71\xf8\x8e\x1b\x8c\x8a\x02", "\x02\x8a\x8c\x1b\x8e\xf8\x71\xbc", 0xbc71f88e1b8c8a02ULL},
        {"\xd2\xb8\x92\xb2\xea\x6e\x54\xd2", "\xd2\x54\x6e\xea\xb2\x92\xb8\xd2", 0xd2b892b2ea6e54d2ULL},
        {"\x47\xdf\xd8\x1c\x8e\x4c\x18\x6f", "\x6f\x18\x4c\x8e\x1c\xd8\xdf\x47", 0x47dfd81c8e4c186fULL},
        {"\x55\x17\x22\x1d\x7a\xd8\xae\xc2", "\xc2\xae\xd8\x7a\x1d\x22\x17\x55", 0x5517221d7ad8aec2ULL},
        {"\xc7\xc3\x1d\x4c\xc9\xf9\x76\x7c", "\x7c\x76\xf9\xc9\x4c\x1d\xc3\xc7", 0xc7c31d4cc9f9767cULL},
        {"\x32\x88\xfd\xe1\x66\xd3\x8e\x35", "\x35\x8e\xd3\x66\xe1\xfd\x88\x32", 0x3288fde166d38e35ULL},
        {"\xd5\xfd\x3e\xa8\xf5\x82\x45\xad", "\xad\x45\x82\xf5\xa8\x3e\xfd\xd5", 0xd5fd3ea8f58245adULL},
        {"\x7b\xf8\x88\x57\x91\xfd\x8f\xee", "\xee\x8f\xfd\x91\x57\x88\xf8\x7b", 0x7bf8885791fd8feeULL},
        {"\x07\x91\x3a\xef\x09\x93\x0d\x9e", "\x9e\x0d\x93\x09\xef\x3a\x91\x07", 0x07913aef09930d9eULL},
        {"\x1c\x38\x57\xb1\xd3\x63\x05\x33", "\x33\x05\x63\xd3\xb1\x57\x38\x1c", 0x1c3857b1d3630533ULL},
        {"\x62\xda\x6a\x2a\xce\xce\x14\xc4", "\xc4\x14\xce\xce\x2a\x6a\xda\x62", 0x62da6a2acece14c4ULL},
        {"\xbf\x7c\xd4\xb3\x75\x36\x1a\x5a", "\x5a\x1a\x36\x75\xb3\xd4\x7c\xbf", 0xbf7cd4b375361a5aULL},
        {"\xf5\x76\x64\x50\x4d\xe4\x0f\x69", "\x69\x0f\xe4\x4d\x50\x64\x76\xf5", 0xf57664504de40f69ULL},
        {"\x57\xcd\x3e\xb3\x2b\xd6\xe0\xfe", "\xfe\xe0\xd6\x2b\xb3\x3e\xcd\x57", 0x57cd3eb32bd6e0feULL},
        {"\x8d\x45\x68\xf2\xa5\xbf\xd6\xbe", "\xbe\xd6\xbf\xa5\xf2\x68\x45\x8d", 0x8d4568f2a5bfd6beULL},
        {"\x7c\xaf\xa3\xfe\x98\x4e\x00\x37", "\x37\x00\x4e\x98\xfe\xa3\xaf\x7c", 0x7cafa3fe984e0037ULL},
        {"\xe8\xf0\x84\x7a\xd4\x2d\xef\x22", "\x22\xef\x2d\xd4\x7a\x84\xf0\xe8", 0xe8f0847ad42def22ULL},
        {"\x03\x5f\x0d\xa7\x20\x62\x9c\xcb", "\xcb\x9c\x62\x20\xa7\x0d\x5f\x03", 0x035f0da720629ccbULL},
        {"\x8e\xa5\x50\x89\x1c\xb0\x16\x52", "\x52\x16\xb0\x1c\x89\x50\xa5\x8e", 0x8ea550891cb01652ULL},
        {"\xba\x5c\x44\x70\x0a\x3d\xd4\x2e", "\x2e\xd4\x3d\x0a\x70\x44\x5c\xba", 0xba5c44700a3dd42eULL},
        {"\xfc\xad\x12\x4f\xe6\x93\x8f\x3b", "\x3b\x8f\x93\xe6\x4f\x12\xad\xfc", 0xfcad124fe6938f3bULL},
        {"\xb8\xe1\x92\x2b\x18\x10\xd9\xd5", "\xd5\xd9\x10\x18\x2b\x92\xe1\xb8", 0xb8e1922b1810d9d5ULL},
        {"\x75\xa1\xba\x86\x19\x9b\x9c\xb2", "\xb2\x9c\x9b\x19\x86\xba\xa1\x75", 0x75a1ba86199b9cb2ULL},
        {"\x26\x82\x63\x62\xd5\x33\xd2\x73", "\x73\xd2\x33\xd5\x62\x63\x82\x26", 0x26826362d533d273ULL},
        {"\x40\x62\xc8\xcb\x1b\xc5\x92\xca", "\xca\x92\xc5\x1b\xcb\xc8\x62\x40", 0x4062c8cb1bc592caULL},
        {"\xdb\x0d\x5b\x38\x0c\xb8\x49\x7c", "\x7c\x49\xb8\x0c\x38\x5b\x0d\xdb", 0xdb0d5b380cb8497cULL},
        {"\x92\x2d\x34\x14\xde\x6c\x9b\x7d", "\x7d\x9b\x6c\xde\x14\x34\x2d\x92", 0x922d3414de6c9b7dULL},
        {"\xae\xe5\x47\x27\xf9\x8f\x88\x9c", "\x9c\x88\x8f\xf9\x27\x47\xe5\xae", 0xaee54727f98f889cULL},
        {"\xa5\x60\x98\x0e\x04\xc6\x90\x7e", "\x7e\x90\xc6\x04\x0e\x98\x60\xa5", 0xa560980e04c6907eULL},
        {"\xad\xa7\x70\x05\x4f\x5a\x87\x15", "\x15\x87\x5a\x4f\x05\x70\xa7\xad", 0xada770054f5a8715ULL},
        {"\xbf\xf3\xd0\xdf\x8b\x93\x78\xe8", "\xe8\x78\x93\x8b\xdf\xd0\xf3\xbf", 0xbff3d0df8b9378e8ULL},
        {"\x73\x87\xcb\x5b\xc4\x66\x0a\xe3", "\xe3\x0a\x66\xc4\x5b\xcb\x87\x73", 0x7387cb5bc4660ae3ULL},
        {"\x7d\x80\x39\xd4\x05\x83\x24\xf5", "\xf5\x24\x83\x05\xd4\x39\x80\x7d", 0x7d8039d4058324f5ULL},
        {"\x0c\xe7\xe7\x3a\x77\x93\x4a\xd6", "\xd6\x4a\x93\x77\x3a\xe7\xe7\x0c", 0x0ce7e73a77934ad6ULL},
        {"\x9b\xbc\xd3\x61\xe2\x71\xd1\x9b", "\x9b\xd1\x71\xe2\x61\xd3\xbc\x9b", 0x9bbcd361e271d19bULL},
        {"\xa3\xe3\x28\x69\xda\x49\x1c\xe5", "\xe5\x1c\x49\xda\x69\x28\xe3\xa3", 0xa3e32869da491ce5ULL},
        {"\x6d\x20\x76\x10\x40\xed\xee\x5e", "\x5e\xee\xed\x40\x10\x76\x20\x6d", 0x6d20761040edee5eULL},
        {"\x29\x67\x40\x1f\xed\x89\xe6\xd1", "\xd1\xe6\x89\xed\x1f\x40\x67\x29", 0x2967401fed89e6d1ULL},
    };
    uint64_t numl, numb;
    uint8_t bufl[8], bufb[8];
    int ii, fail;

    fail = 0;
    for(ii = 0; sizeof(tests) / sizeof(tests[0]) > ii; ii++)
    {
        numl = UP_GETBUF64LE(tests[ii].little);
        numb = UP_GETBUF64BE(tests[ii].big);
        UP_SETBUF64LE(bufl, tests[ii].native);
        UP_SETBUF64BE(bufb, tests[ii].native);
        if(numl != tests[ii].native ||
           numb != tests[ii].native ||
           memcmp(bufl, tests[ii].little, 8) ||
           memcmp(bufb, tests[ii].big, 8))
        {
            fail = 1;
            printf("64/%d: getle=%s getbe=%s setle=%s setbe=%s\n", ii,
                   (numl == tests[ii].native ? "pass" : "fail"),
                   (numb == tests[ii].native  ? "pass" : "fail"),
                   (!memcmp(bufl, tests[ii].little, 8) ? "pass" : "fail"),
                   (!memcmp(bufb, tests[ii].big, 8) ? "pass" : "fail"));
        }
    }

    return fail;
}

int
main()
{
    int f16 = dotest16();
    int f32 = dotest32();
    int f64 = dotest64();

    return f16 || f32 || f64;
}

/*
import random, struct

def esc(bin):
    return ''.join(['\\x%02x' % ord(ii) for ii in bin])

for bits, fmt, pfx in ((16, 'H', 'U'), (32, 'L', 'UL'), (64, 'Q', 'ULL')):
    print '''int
dotest%d(void)
{
    struct { char *big; char *little; uint%d_t native; } tests[] = {''' % \
    (bits, bits)
    for dummy in xrange(128):
        num = random.getrandbits(bits)
        little = struct.pack('<' + fmt, num)
        big = struct.pack('>' + fmt, num)
        print '        {"%s", "%s", 0x%0*x%s},' % \
              (esc(big), esc(little), bits / 4, num, pfx)
    print '''    };
    uint%(i)d_t numl, numb;
    uint8_t bufl[%(y)d], bufb[%(y)d];
    int ii, fail;

    fail = 0;
    for(ii = 0; sizeof(tests) / sizeof(tests[0]) > ii; ii++)
    {
        numl = UP_GETBUF%(i)dLE(tests[ii].little);
        numb = UP_GETBUF%(i)dBE(tests[ii].big);
        UP_SETBUF%(i)dLE(bufl, tests[ii].native);
        UP_SETBUF%(i)dBE(bufb, tests[ii].native);
        if(numl != tests[ii].native ||
           numb != tests[ii].native ||
           memcmp(bufl, tests[ii].little, %(y)d) ||
           memcmp(bufb, tests[ii].big, %(y)d))
        {
            fail = 1;
            printf("%(i)d/%%d: getle=%%s getbe=%%s setle=%%s setbe=%%s\\n", ii,
                   (numl == tests[ii].native ? "pass" : "fail"),
                   (numb == tests[ii].native  ? "pass" : "fail"),
                   (!memcmp(bufl, tests[ii].little, %(y)d) ? "pass" : "fail"),
                   (!memcmp(bufb, tests[ii].big, %(y)d) ? "pass" : "fail"));
        }
    }

    return fail;
}
''' % {'i' : bits, 'y' : bits / 8}
*/
